## DDoS基础技术知识
*author: rain.lee@2019.4.10*

#### DDoS攻防简史
- 1996.9.6(攻击)
  - 事件: 第一次DoS攻击
  - 地点: 美国·纽约·Panix公司
  - 攻击手段: TCP syn攻击, 150次/s
  - 影响: 6000+名用户无法收取邮件  
<br>   

- 1999(攻击)
  - 出现僵尸网络: 利用P2P IRC控制协议
<br>

- 1999.8.17(攻击)
  - 事件: 第一次DDoS攻击
  - 地点: 美国明尼苏达大学
  - 攻击手段: UDP flood, 227台肉鸡
  - 影响: 1+16 台服务器停止服务终止
  - 使用工具: Trinoo
<br>
- 2002.10.21(攻击)
  - 事件: 第一次DNS攻击
  - 攻击手段: UDP flood, 100Mbps
  - 影响: 13台根域名服务器有9台不能正常提供服务
<br>

- 2002.10.25(防护)
  - 事件: 中国第一款Anti-DDoS防护设备上市, 产品名称: 绿盟·黑洞(Collapsar)
  - 防护手段: 基于4层报文特征做流量清洗, 区分出合法报文和非法报文, 对UDP flood, ICMP flood有清洗效果; 超过上限则黑洞
  - 防护流量: 10Mbps
<br>

- 2005 (攻击)
  - 事件: CC攻击(Challenge Collapsar)诞生
  - 发明者: Qaker, 北京某高校毕业生
  - 相关人: Collapsar 之父Y博士
  - 攻击手段: 利用互联网上的免费proxy, 发送大量的合法请求, 造成服务器资源不可用; 通过proxy可以隐藏攻击源IP
  - 影响: 诞生以后的10几年, 几乎是DDoS设备和高防IP服务的噩梦. 
  <br>
 
 > 2005年, Qaker在一些互联网黑客社区初露峥嵘，Collapsar之父y博士有意将他拉入Collapsar研发团队中，并邀请他到Nsfcous北京总部参加面试。但面试当日，y博士临时由于其他事情，错过了Qaker的面试，Qaker觉得自己受到Nsfcous的轻视而愤怒。在那之后，Qaker埋头研究Collapsar的防护算法，并在很短的事件内找到了击败Collapsar的方式。Qaker将之做成工具发布到互联网黑客社区，并命名Challenge Collapsar(挑战黑洞)，这就是我们今天所熟知的CC攻击。也由此给中国乃至世界互联网安全带来长达十年的困扰。***CC攻击可怕之处在于通过CC攻击方式模拟的虚假用户，几乎和真实用户行为完全一致，很难通过算法加以识别。***

  [CC攻击小故事](https://www.sohu.com/a/130516653_375213)
  <br>

- 2009.9.5(防护)
  - DNSPod推出DNS防护功能
<br>

- 2010 (攻击)
  - 攻击峰值达到100Gbps, DDoS攻击进入G时代
<br>

- 2013.3.18(攻击)
  - 事件: DDoS攻击进入300G时代
  - 攻击手段: DNS反射. 10Gbps-309Gbps
  - 影响: Spamhaus, 一家致力于反垃圾邮件的非盈利组织. 由于有CloudFlare防护, 实际影响未知. 
<br>

- 2014 (防护)
  - 事件: 阿里云推出高防IP, 可防护300G DDoS攻击
  - 防护手段: 
    - 传统DDoS设备的云化(软化), 可有效防御基于明显特征的DDoS攻击(eg. TCP syn/UDP flood等); 
    - 对CC防护效果比较差, 只能防御简单的CC
    - 有防护上限, 超过上限以后, 只能将服务器黑洞.
<br>

- 2014 (攻击)
  - 攻击峰值达到400Gbps
<br>

- 2015 (攻击)
  - 攻击峰值达到453.8Gbps
<br>
- 2016 (攻击)
  - 攻击流量达到602Gbps
<br>

- 2017.6 (防护)
  - 事件: 太极盾上市, 一款基于SDP理念的云抗D产品. 
  - 防护手段:
    - 通过在终端App嵌入安全SDK, 建立App和海量分布式BGP云节点之间的加密隧道, 屏蔽CC和DDoS非法请求
    - 彻底解决DDoS/CC/DNS DDoS攻击
    - 由于需要嵌入SDK, 不能解决纯Web网页的攻击
<br>

- 2018(防护)
  - 事件: 阿里云推出600G BGP高防IP, 
  - 效果: 进一步改善最终用户平时的使用体验, 2014年阿里云推出的300G高防(电信/联通/移动), 存在接入运营商互联互通问题, 导致最终用户接入体验较差. 
  <br>

- 2018 (攻击)
  - 事件: 攻击进入T时代. 
  - 攻击手段: memcached UDP反射攻击. 攻击峰值达到1.72Tbps
  - >影响: 美国东部时间周三下午，**GitHub**透露其可能遭受了有史最强的DDoS攻击，专家称攻击者采用了放大攻击的新方法Memcached反射攻击，可能会在未来发生更大规模的分布式拒绝服务（DDoS）攻击。对GitHub平台的第一次峰值流量攻击达到了1.35Tbps，随后又出现了另外一次400Gbps的峰值，这可能也将成为目前记录在案的最强DDoS攻击，此前这一数据为1.1Tbps。
  - Tips: 
  [What is memcached?](https://blog.cloudflare.com/memcrashed-major-amplification-attacks-from-port-11211/)
<br>
<center><strong>The DDoS and Anti-DDoS will be continued...</strong></center>
<br>

#### DDoS攻击手段简介
-  带宽消耗型攻击
   -  目标: 占满攻击目标的带宽/消耗服务器和网络设备的网络处理能力, 使服务器拒绝服务
   -  手段: 使用大量的受控主机(肉鸡, 肉机, 僵尸), 向攻击目标发送海量的网络数据包
   -  典型: 
      -  ICMP flood/IGMP flood/UDP flood: 由肉鸡上的攻击工具直接发出大量的请求
      -  反射攻击(DRDOS)和放大攻击: 利用路由器或服务器等设施对请求产生应答, 从而反射流量并隐藏攻击源. NTP reflection/Memcached/TCP ACK/DNS reflection/SNMP reflection
    <br>
-  资源消耗型攻击
   -  目标: 占满攻击目标服务器的系统资源.
   -  手段: 略
   -  典型:
      -  洪水型
         -  TCP 连接洪水: 直接建立大量的TCP连接消耗服务器资源, 合法用户无法建立正常连接
         -  TCP SYN洪水: 大量建立一半的连接, 消耗服务器资源
         -  TCP PSH+ACK洪水攻击: 让服务器不停清空缓冲区
         -  TCP RST: 盲打已经建立的连接, 一旦打中, 则断开合法连接. 
         -  SSL 洪水
      -  慢速攻击: 发送少量报文即可实现对服务器资源的消耗
         -  Sockstress: TCP握手过程中, 发送TCP ACK WIN=0, 导致服务器端一直询问客户端的发送窗口是否空闲. 
         -  SSL THC: 利用客户端和服务器端的SSL握手资源消耗不对等进行攻击
  <br>
-  业务消耗型攻击(应用层攻击)
   -  CC攻击: 利用大量的以小博大合法请求+proxy隐藏攻击源
   -  HTTP 洪水
   -  Slowloris 慢速攻击: (利用http协议中请求以\r\n结尾), 攻击者发送HTTP请求不带\r\n, 导致服务器Web应用认为请求没有结束. 
   -  慢速POST攻击: 利用Content-Length字段, 客户端慢慢发送数据, 直到达到Content-Length的值, 从而消耗Web Server的资源
   -  数据处理过程攻击(正则表达式攻击[ReDOS]/Hash冲突攻击)
  <br>
-  DNS攻击
   -  目标: DNS解析服务不可用
   -  手段: 发送DNS洪水
   -  典型: DNS query洪水/DNS NXDOMAIN洪水攻击
  <br>

  ***小结***: DDoS攻击是攻击者通过控制大量肉鸡, 分布式的向一个几乎完全完全暴露的集中式目标发送大量的请求或者报文, 消耗服务器的网络, 系统或应用资源, 直到服务器拒绝服务. 
  <br>
#### DDoS防护手段简介
- 带宽消耗型攻击
  - 超大带宽+报文特征清洗
- 资源消耗型攻击
  - 超大带宽+报文特征清洗
- 业务消耗型攻击
  - 客户增加业务处理能力
  - 单IP QPS特征
- DNS攻击
  - DNS黑洞

#### 太极盾是一个什么样的存在?

> DNS攻击防护
  - 采用动态Token技术, 无需网络交互, 客户端SDK自动生成云防护节点IP, 无需调度中心及DNS域名解析, 有效避免DNS攻击
- DDoS攻击防护 (整合带宽消耗型和资源消耗型攻击)
  - 客户端集成安全SDK, 采用欺骗混淆技术, 难以获取云防护节点IP
  - 10000+ 全球云防护节点全网共享, 单节点被攻击时, 该节点用户秒级切换, 随机分配到全网不同的云节点中, 合法用户遭受二次攻击的概率仅为亿分之一.
  - 智能识别并锁定恶意泄漏IP终端, 使攻击行为始终处于自耗尽状态, 消耗攻击资源
- CC攻击防护
  - 在客户端SDK与防护节点之间建立加密的IP隧道, 只允许通过SDK接入的合法业务进入.
  - 基于创新的报文基因技术, 确保每条报文都具备唯一的基因宝石, 拒绝重放报文进入, 可彻底防御CC攻击. 
  - 提取APP证书签名信息和设备指纹, 确保仅合法的终端和合法APP接入. 
